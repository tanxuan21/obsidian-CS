> 造成丟失，延遲的原因？
> 分組交換機獲得數據包比它轉發的速度快得多。那麼太多的數據包就只能丟棄。分組交換機用緩衝隊列來一定程度的緩解丟棄的問題，轉而一個折中的情況：數據包進入隊列，延遲發送。

# 延遲：
- 處理延遲，查找路由表，是固定的。
- 排隊延遲，隨機的。根據網絡情況。
- 傳輸延遲
傳輸延遲=分組長度/鏈路帶寬
- 傳播延遲
光速。距離在天體尺度不能忽略。

車隊理解：傳輸延遲，傳播延遲
![[Pasted image 20241005173700.png]]

## 流量強度？

流量強度 = 分組長度 * 分組到達隊列的速度 / 鏈路帶寬
流量強度取值0-1。
流量強度接近1，排隊延遲接近無限大。
不能設計流量強度等於1的情況。
![[Pasted image 20241005174236.png]]

## 實驗：查看往返延遲：
```shell
traceroute [ipaddress]
```
### 原理：基於ICMP協議

數據報頭有一個TTL（time to live），每經過一個路由器，TTL減一。減沒了，發回原主機。

#### 如何獲得每一跳（hip）的延遲？
將TTL設成i。那麼，在第i跳時，就會被第i個路由器幹掉，並返回RTT（round trip time）
#### 到達目標後如何？
最後到達目標主機，通過設定一個奇怪的端口號，這個端口號一定沒有進程在守護；這時，目標主機就會丟棄這個數據報，並向原主機返回由於無效端口而被丟棄的消息。

# 丟失

丟失了怎麼辦？
- 上層重傳，自身所在的鏈路不可靠，但是上層鏈路可靠。
- 原主機重傳，自身所在的鏈路不可靠，沒有可靠的上層鏈路。
- 不重傳。比如原主機就是UDP協議，本來就不關心丟包的問題。
>低層的協議本來就可靠，那麼高層就不管可靠性。比如以太網，他的底層鏈路很可靠，它丟失了就不重傳了。
   但是向無線網，它就不可靠。所以上層的協議需要為可靠性下功夫。傳輸到收到為止。
>**響鼓不用重錘**

# 吞吐量
瞬間吞吐量
平均吞吐量

## 瓶頸鏈路
吞吐量最小的鏈路。注意，瓶頸鏈路不一定是物理帶寬最小的鏈路。也就是說，評價瓶頸鏈路的帶寬數不是鏈路的物理帶寬。
微觀上看，隨便選擇A->B之間的一個鏈路l，首先我們要知道，網路是共享的，按需使用的。那麼l就不是AB專用的。假設I被n對主機所使用，l的帶寬是r，那麼l對AB的帶寬就是r/n。這個數才是去評價瓶頸鏈路的帶寬值。